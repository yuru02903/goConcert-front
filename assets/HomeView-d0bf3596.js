import{T as V,X as b,Y as _,Z as n,ab as h,c as t,_ as w,af as G,a4 as a,ai as P,a9 as x}from"./index-c58a86af.js";import{c as F,a as i,d as k,e as p,f as q,V as B}from"./index.esm-ad1d64b1.js";import{u as S,a as r}from"./vee-validate.esm-4345f00f.js";import{V as $,a as E}from"./VRow-965a2736.js";import{V as A}from"./VDivider-841cc530.js";const D=x("h1",null,"我的資料",-1),X={__name:"HomeView",setup(I){const{apiAuth:d}=h(),m=V(),u=F({name:i().required("缺少演唱會名稱"),date:k().required("缺少演唱會日期").min(new Date,"日期須大於今天"),performer:i().required("缺少表演者名稱"),originalPrice:p().typeError("票券原價格式錯誤，請填寫數字").required("請填寫票券原價").min(0,"價格不能小於0"),price:p().typeError("票券售價格式錯誤，請填寫數字").required("請填寫票券售價").min(0,"價格不能小於0"),description:i(),categoryCountry:i().required("請選擇表演者國籍").test("isCategoryCountry","表演者國籍有誤",e=>CategoryCountry.includes(e)),categoryGroup:i().required("請選擇表演者性質").test("isCategoryGroup","表演者性質有誤",e=>CategoryGroup.includes(e)),sell:q()}),{handleSubmit:g,isSubmitting:y,resetForm:M}=S({validationSchema:u,initialValues:{name:"",performer:"",originalPrice:0,price:0,description:"",categoryCountry:"",categoryGroup:"",sell:!1}}),l=r("name");r("date"),r("performer"),r("originalPrice"),r("price"),r("description"),r("categoryCountry"),r("categoryGroup"),r("sell");const f=g(async e=>{var o,s;try{dialogId.value===""?await d.post("/tickets",{name:e.name,date:e.date,performer:e.performer,originalPrice:e.originalPrice,price:e.price,description:e.description,categoryCountry:e.categoryCountry,categoryGroup:e.categoryGroup,sell:e.sell}):await d.patch("/users/"+dialogId.value,{name:e.name,date:e.date,performer:e.performer,originalPrice:e.originalPrice,price:e.price,description:e.description,categoryCountry:e.categoryCountry,categoryGroup:e.categoryGroup,sell:e.sell}),m({text:"編輯成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})}catch(c){console.log(c);const C=((s=(o=c==null?void 0:c.response)==null?void 0:o.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";m({text:C,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(e,o)=>(b(),_($,{class:"py-8 px-4 ma-0"},{default:n(()=>[t(E,{cols:"12",class:""},{default:n(()=>[D,t(A)]),_:1}),t(B,{disabled:a(y),onSubmit:P(a(f),["prevent"])},{default:n(()=>[t(w,{class:"mx-auto",width:"80%",style:{"background-color":"#FFFBE6"}},{default:n(()=>[t(G,{label:"帳號",modelValue:a(l).value.value,"onUpdate:modelValue":o[0]||(o[0]=s=>a(l).value.value=s),"error-messages":a(l).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1}))}};export{X as default};
