import{T as B,r as s,X as w,Y as x,Z as r,c as t,af as I,aB as A,V as k,_ as L,a9 as S,ab as T}from"./index-6859542d.js";import{V,a as m}from"./VRow-10742534.js";import{V as F}from"./VDivider-5126788b.js";import{V as U,a as D}from"./VList-968969b0.js";import{V as G}from"./VDataTableServer-8569a36f.js";import"./VSelect-c690572f.js";import"./VSlideGroup-0877d4d9.js";const K=S("h1",null,"票券管理",-1),Z={__name:"TicketsView",setup(N){const{apiAuth:h}=T(),_=B(),y=e=>{e?(dialogId.value=e._id,name.value.value=e.name,date.value.value=e.date,performer.value.value=e.performer,originalPrice.value.value=e.originalPrice,price.value.value=e.price,categoryCountry.value.value=e.categoryCountry,categoryGroup.value.value=e.categoryGroup,sell.value.value=e.sell,description.value.value=e.description):dialogId.value="",dialog.value=!0},v=s(10),u=s([{key:"createdAt",order:"desc"}]),i=s(1),p=s([]),C=[{title:"賣家",align:"center",sortable:!0,key:"seller.account"},{title:"名稱",align:"center",sortable:!0,key:"name"},{title:"表演者",align:"center",sortable:!0,key:"performer"},{title:"原價",align:"center",sortable:!0,key:"originalPrice"},{title:"售價",align:"center",sortable:!0,key:"price"},{title:"國籍",align:"center",sortable:!0,key:"categoryCountry"},{title:"性質",align:"center",sortable:!0,key:"categoryGroup"},{title:"查看",align:"center",sortable:!1,key:"eye"},{title:"禁售",align:"center",sortable:!1,key:"cancel"}],g=s(!0),b=s(0),c=s(""),n=async()=>{var e,l,a,d;g.value=!0;try{const{data:o}=await h.get("/tickets/all",{params:{page:i.value,itemsPerPage:v.value,sortBy:((e=u.value[0])==null?void 0:e.key)||"createdAt",sortOrder:((l=u.value[0])==null?void 0:l.order)==="asc"?1:-1,search:c.value}});p.value.splice(0,p.value.length,...o.result.data),b.value=o.result.total}catch(o){console.log(o);const P=((d=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:d.message)||"發生錯誤，請稍後再試";_({text:P,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}g.value=!1};n();const f=()=>{i.value=1,n()};return(e,l)=>(w(),x(V,{class:"pa-8 ma-0 mb-8",style:{width:"80%"}},{default:r(()=>[t(m,{cols:"12",class:""},{default:r(()=>[K,t(F)]),_:1}),t(L,{class:"mx-auto",width:"80%",style:{"background-color":"#FFFBE6"}},{default:r(()=>[t(U,null,{default:r(()=>[t(D,null,{default:r(()=>[t(V,null,{default:r(()=>[t(m,{cols:"12"},{default:r(()=>[t(I,{label:"搜尋","append-icon":"mdi-magnify",modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value=a),"onClick:append":f,onKeydown:A(f,["enter"])},null,8,["modelValue"])]),_:1}),t(m,{cols:"12"},{default:r(()=>[t(G,{"items-per-page":v.value,"onUpdate:itemsPerPage":[l[1]||(l[1]=a=>v.value=a),n],"sort-by":u.value,"onUpdate:sortBy":[l[2]||(l[2]=a=>u.value=a),n],page:i.value,"onUpdate:page":[l[3]||(l[3]=a=>i.value=a),n],items:p.value,headers:C,loading:g.value,"items-length":b.value,search:c.value,hover:""},{"item.eye":r(({item:a})=>[t(k,{icon:"mdi-eye",variant:"text",color:"grey",onClick:d=>y(a)},null,8,["onClick"])]),"item.cancel":r(({item:a})=>[t(k,{icon:"mdi-close",variant:"text",color:"red",onClick:d=>y(a)},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Z as default};
