import{W as N,X as r,Y as d,Z as e,c as t,a3 as U,a1 as h,aa as i,ae as A,a9 as c,V as B,_ as K,T as R,r as f,l as v,C as E,af as G,ag as M,a as W,$ as w,a7 as P,F as T,ab as X,ah as Y,ai as Z}from"./index-677308fb.js";import{V as p}from"./VRow-4d2e5ac7.js";import{V as s}from"./VCol-1f3ac925.js";import{V as I}from"./VDivider-d8cfd718.js";import{V as j,c as q,a as S}from"./VList-89e46962.js";import{V as H}from"./VContainer-2285781b.js";import{V as J}from"./VPagination-0d6f2597.js";const O=c("div",{style:{height:"100%","line-height":"80px"}},[c("h3",{class:"text-center",style:{color:"white"}}," 我要購買 ")],-1),Q={__name:"TicketCard",props:["_id","name","date","performer","venue","area","row, seat","originalPrice","price","seller","buyer","categoryCountry","description","sell"],setup(n){return(k,x)=>{const u=N("router-link");return r(),d(K,null,{default:e(()=>[t(p,{class:"ma-0 pa-0"},{default:e(()=>[t(s,{cols:"3"},{default:e(()=>[t(U,{style:{}},{default:e(()=>[h(i(n.name),1)]),_:1}),t(A,{style:{color:"#e76813","font-weight":"bolder",opacity:"1"},class:"pb-1"},{default:e(()=>[h(" 售價："+i(n.price),1)]),_:1})]),_:1}),t(s,{cols:"2",class:"ma-0 pa-3"},{default:e(()=>[c("h5",null,"日期："+i(n.date),1),c("h5",null,"演出者："+i(n.performer),1),c("h5",null,"原價："+i(n.originalPrice),1),c("h5",null,"賣家："+i(n.seller.account),1)]),_:1}),t(s,{cols:"5"},{default:e(()=>[t(B,{class:"mx-1",rounded:"",size:"small",style:{"font-weight":"700"},color:"bgPrimary"},{default:e(()=>[h(i(n.categoryCountry),1)]),_:1})]),_:1}),t(I,{vertical:""}),t(s,{cols:"2",style:{"background-color":"#e76813"}},{default:e(()=>[t(u,{class:"text-primary text-decoration-none",to:"/tickets/"+n._id},{default:e(()=>[O]),_:1},8,["to"])]),_:1})]),_:1})]),_:1})}}};const ee=c("h2",null,"票券交流",-1),te=c("h2",{class:"text-gray"},"目前尚無可購買票券",-1),V=5,ue={__name:"TicketsView",setup(n){const{api:k}=X(),x=R(),u=f([]),L=v(()=>[{country:"台灣"},{country:"韓國"},{country:"日本"},{country:"歐美"},{country:"泰國"},{country:"其他"}]),b=f(["Country"]),g=f(""),m=f(1),$=v(()=>Math.ceil(u.value.length/V)),z=v(()=>{const o=(m.value-1)*V,l=o+V;return window.scrollTo(0,0),console.log("change page"),u.value.slice(o,l)}),D=async o=>{m.value=o},C=async()=>{var o,l;try{const{data:a}=await k.get("/tickets/all",{params:{itemsPerPage:-1,search:g.value}});u.value.splice(0,u.value.length,...a.result.data),await E()}catch(a){console.log(a);const y=((l=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";x({text:y,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};C();const F=async o=>{g.value=o,_()},_=async()=>{C(),m.value=1};return(o,l)=>(r(),d(p,{class:"pa-0 ma-0"},{default:e(()=>[t(s,{cols:"2",class:"pa-2 ma-0",style:{"border-right":"1px solid rgb(224, 224, 224)"}},{default:e(()=>[t(G,{label:"搜尋","append-icon":"mdi-magnify",rounded:"",variant:"outlined","base-color":"rgb(224, 224, 224)","bg-color":"rgb(256, 256, 256)",density:"compact",class:"pt-4 pa-1",modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=a=>g.value=a),"onClick:append":_,onKeydown:M(_,["enter"])},null,8,["modelValue"]),t(j,{height:"100vh","bg-color":"bgPrimary",opened:b.value,"onUpdate:opened":l[1]||(l[1]=a=>b.value=a)},{default:e(()=>[t(q,{value:"Country",opened:""},{activator:e(({props:a})=>[t(S,W(a,{title:"國籍"}),null,16)]),default:e(()=>[(r(!0),w(T,null,P(L.value,a=>(r(),d(S,{key:a.country,class:"paddingx-16"},{default:e(()=>[t(B,{text:a.country,variant:"text",onClick:y=>F(a.country),width:"100%",style:{"text-align":"left"}},null,8,["text","onClick"])]),_:2},1024))),128))]),_:1})]),_:1},8,["opened"])]),_:1}),t(s,{cols:"10",class:"pa-0 ma-0"},{default:e(()=>[t(H,null,{default:e(()=>[t(p,null,{default:e(()=>[t(s,{cols:"12"},{default:e(()=>[ee]),_:1}),t(I)]),_:1}),u.value.length>0?(r(),d(p,{key:0},{default:e(()=>[(r(!0),w(T,null,P(z.value,(a,y)=>(r(),d(s,{cols:"12",key:y,class:"ticketCard"},{default:e(()=>[t(Q,Y(Z(a)),null,16)]),_:2},1024))),128)),t(s,{cols:"12"},{default:e(()=>[t(J,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=a=>m.value=a),length:$.value,onInput:D},null,8,["modelValue","length"])]),_:1})]),_:1})):(r(),d(p,{key:1},{default:e(()=>[t(s,{cols:"12",class:"text-center"},{default:e(()=>[te]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1}))}};export{ue as default};
