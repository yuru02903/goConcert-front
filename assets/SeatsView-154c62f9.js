import{T as E,r as S,X as $,$ as A,c as e,Z as a,a8 as N,F as P,ab as h,V as _,a1 as i,a4 as l,ae as I,_ as R,a3 as X,aa as Z,ay as j,ad as d,a0 as z,a2 as G,a9 as H}from"./index-472d0ee0.js";import{c as J,a as y,e as w,u as K,b as n,V as L}from"./index.esm-e214c10f.js";import{V as k,a as t}from"./VRow-88b978d7.js";import{c as O}from"./VList-54ec541c.js";import{a as Q}from"./VDataTableServer-832218e4.js";import"./VSlideGroup-e588eb32.js";const W=H("h1",null,"座位管理",-1),te={__name:"SeatsView",setup(Y){const{apiAuth:F}=h(),x=E(),m=S(!1),c=S(""),B=()=>{c.value="",m.value=!0},C=()=>{m.value=!1,T()},D=J({venue:y().required("缺少場館名稱"),area:y().required("缺少區域名稱"),row:w().typeError("格式錯誤，請填寫數字").required("缺少排數"),seat1:w().typeError("格式錯誤，請填寫數字").required("缺少開始座號"),seat2:w().typeError("格式錯誤，請填寫數字").required("缺少結束座號")}),{handleSubmit:M,isSubmitting:V,resetForm:T}=K({validationSchema:D}),v=n("venue"),f=n("area"),p=n("row"),g=n("seat1"),b=n("seat2"),U=M(async u=>{var s,o;try{for(let r=u.seat1;r<=u.seat2;r++)await F.post("/seats",{venue:u.venue,area:u.area,row:u.row,seat:r});x({text:c.value===""?"新增成功":"編輯成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),C()}catch(r){console.log(r);const q=((o=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:o.message)||"發生錯誤，請稍後再試";x({text:q,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(u,s)=>($(),A(P,null,[e(k,{class:"py-8 px-4 ma-0"},{default:a(()=>[e(t,{cols:"12",class:""},{default:a(()=>[W,e(O)]),_:1}),e(t,{cols:"12"},{default:a(()=>[e(_,{color:"green",onClick:B},{default:a(()=>[i("新增座位")]),_:1})]),_:1}),e(t,{cols:"12"},{default:a(()=>[e(Q)]),_:1})]),_:1}),e(N,{modelValue:m.value,"onUpdate:modelValue":s[5]||(s[5]=o=>m.value=o),width:"500px"},{default:a(()=>[e(L,{disabled:l(V),onSubmit:I(l(U),["prevent"])},{default:a(()=>[e(R,null,{default:a(()=>[e(X,null,{default:a(()=>[i(Z(c.value===""?"新增座位":"編輯座位"),1)]),_:1}),e(j,null,{default:a(()=>[e(k,null,{default:a(()=>[e(t,{cols:"12"},{default:a(()=>[e(d,{label:"場館名稱",clearable:"",modelValue:l(v).value.value,"onUpdate:modelValue":s[0]||(s[0]=o=>l(v).value.value=o),"error-messages":l(v).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(t,{cols:"12"},{default:a(()=>[e(d,{label:"區域",clearable:"",modelValue:l(f).value.value,"onUpdate:modelValue":s[1]||(s[1]=o=>l(f).value.value=o),"error-messages":l(f).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(t,{cols:"12"},{default:a(()=>[e(d,{label:"排數",clearable:"",modelValue:l(p).value.value,"onUpdate:modelValue":s[2]||(s[2]=o=>l(p).value.value=o),"error-messages":l(p).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(t,{cols:"6"},{default:a(()=>[e(d,{label:"開始座號",clearable:"",modelValue:l(g).value.value,"onUpdate:modelValue":s[3]||(s[3]=o=>l(g).value.value=o),"error-messages":l(g).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(t,{cols:"6"},{default:a(()=>[e(d,{label:"結束座號",clearable:"",modelValue:l(b).value.value,"onUpdate:modelValue":s[4]||(s[4]=o=>l(b).value.value=o),"error-messages":l(b).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(z,null,{default:a(()=>[e(G),e(_,{color:"red",disabled:l(V),onClick:C},{default:a(()=>[i("取消")]),_:1},8,["disabled"]),e(_,{color:"green",type:"submit",loading:l(V)},{default:a(()=>[i("送出")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64))}};export{te as default};
