import{W as N,X as i,Y as y,Z as t,c as e,a3 as U,a1 as _,aa as r,ae as A,a9 as c,V as B,_ as K,T as R,r as g,l as h,C as E,af as G,ag as M,a as W,$ as w,a7 as P,F as T,ab as X,ah as Y,ai as Z}from"./index-ee21c5dd.js";import{V as f}from"./VRow-c2407045.js";import{V as n}from"./VCol-1ff7b675.js";import{V as I}from"./VDivider-2483a20b.js";import{V as j,c as q,a as S}from"./VList-8c1de52e.js";import{V as H}from"./VContainer-eeaaaf3c.js";import{V as J}from"./VPagination-153f99fd.js";const O=c("div",{style:{height:"100%","line-height":"80px"}},[c("h3",{class:"text-center",style:{color:"white"}}," 我要購買 ")],-1),Q={__name:"TicketCard",props:["_id","name","date","performer","venue","area","row, seat","originalPrice","price","seller","buyer","categoryCountry","description","sell"],setup(s){return(k,b)=>{const u=N("router-link");return i(),y(K,null,{default:t(()=>[e(f,{class:"ma-0 pa-0"},{default:t(()=>[e(n,{cols:"3"},{default:t(()=>[e(U,{style:{}},{default:t(()=>[_(r(s.name),1)]),_:1}),e(A,{style:{color:"#e76813","font-weight":"bolder",opacity:"1"},class:"pb-1"},{default:t(()=>[_(" 售價："+r(s.price),1)]),_:1})]),_:1}),e(n,{cols:"2",class:"ma-0 pa-3"},{default:t(()=>[c("h5",null,"日期："+r(s.date),1),c("h5",null,"演出者："+r(s.performer),1),c("h5",null,"原價："+r(s.originalPrice),1),c("h5",null,"賣家："+r(s.seller.account),1)]),_:1}),e(n,{cols:"5"},{default:t(()=>[e(B,{class:"mx-1",rounded:"",size:"small",style:{"font-weight":"700"},color:"bgPrimary"},{default:t(()=>[_(r(s.categoryCountry),1)]),_:1})]),_:1}),e(I,{vertical:""}),e(n,{cols:"2",style:{"background-color":"#e76813"}},{default:t(()=>[e(u,{class:"text-primary text-decoration-none",to:"/tickets/"+s._id},{default:t(()=>[O]),_:1},8,["to"])]),_:1})]),_:1})]),_:1})}}};const ee=c("h2",null,"票券交流",-1),V=5,ce={__name:"TicketsView",setup(s){const{api:k}=X(),b=R(),u=g([]),L=h(()=>[{country:"台灣"},{country:"韓國"},{country:"日本"},{country:"歐美"},{country:"泰國"},{country:"其他"}]),x=g(["Country"]),m=g(""),d=g(1),$=h(()=>Math.ceil(u.value.length/V)),z=h(()=>{const o=(d.value-1)*V,l=o+V;return window.scrollTo(0,0),console.log("change page"),u.value.slice(o,l)}),D=async o=>{d.value=o},C=async()=>{var o,l;try{const{data:a}=await k.get("/tickets/all",{params:{itemsPerPage:-1,search:m.value}});u.value.splice(0,u.value.length,...a.result.data),await E()}catch(a){console.log(a);const p=((l=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";b({text:p,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};C();const F=async o=>{m.value=o,v()},v=async()=>{C(),d.value=1};return(o,l)=>(i(),y(f,{class:"pa-0 ma-0"},{default:t(()=>[e(n,{cols:"2",class:"pa-2 ma-0",style:{"border-right":"1px solid rgb(224, 224, 224)"}},{default:t(()=>[e(G,{label:"搜尋","append-icon":"mdi-magnify",rounded:"",variant:"outlined","base-color":"rgb(224, 224, 224)","bg-color":"rgb(256, 256, 256)",density:"compact",class:"pt-4 pa-1",modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=a=>m.value=a),"onClick:append":v,onKeydown:M(v,["enter"])},null,8,["modelValue"]),e(j,{height:"100vh","bg-color":"bgPrimary",opened:x.value,"onUpdate:opened":l[1]||(l[1]=a=>x.value=a)},{default:t(()=>[e(q,{value:"Country",opened:""},{activator:t(({props:a})=>[e(S,W(a,{title:"國籍"}),null,16)]),default:t(()=>[(i(!0),w(T,null,P(L.value,a=>(i(),y(S,{key:a.country,class:"paddingx-16"},{default:t(()=>[e(B,{text:a.country,variant:"text",onClick:p=>F(a.country),width:"100%",style:{"text-align":"left"}},null,8,["text","onClick"])]),_:2},1024))),128))]),_:1})]),_:1},8,["opened"])]),_:1}),e(n,{cols:"10",class:"pa-0 ma-0"},{default:t(()=>[e(H,null,{default:t(()=>[e(f,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[ee]),_:1}),e(I)]),_:1}),e(f,null,{default:t(()=>[(i(!0),w(T,null,P(z.value,(a,p)=>(i(),y(n,{cols:"12",key:p,class:"ticketCard"},{default:t(()=>[e(Q,Y(Z(a)),null,16)]),_:2},1024))),128)),e(n,{cols:"12"},{default:t(()=>[e(J,{modelValue:d.value,"onUpdate:modelValue":l[2]||(l[2]=a=>d.value=a),length:$.value,onInput:D},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{ce as default};
